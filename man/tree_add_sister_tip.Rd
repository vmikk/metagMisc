% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tree_add_sister_tip.R
\name{tree_add_sister_tip}
\alias{tree_add_sister_tip}
\title{Add sister tips to a phylogenetic tree}
\usage{
tree_add_sister_tip(
  tree,
  new.tip.label,
  sister.tip.label,
  branch.length = 1e-05
)
}
\arguments{
\item{tree}{A phylogenetic tree object of class \code{phylo}}

\item{new.tip.label}{Character vector of labels for the new tip(s) to add}

\item{sister.tip.label}{Character vector of existing tip labels that will become 
sisters to the new tips. If a single value is provided and multiple new tips 
are specified, all new tips will be added as sisters to the same tip}

\item{branch.length}{Numeric value for the branch length of new tips (default: 1e-5)}
}
\value{
A modified phylogenetic tree object of class \code{phylo} with the new 
  sister tip(s) added
}
\description{
Adds one or more sister tips to an existing phylogenetic tree. 
Sister tips share the same immediate common ancestor with the specified existing tip(s).
}
\details{
This function supports three main scenarios: 
(1) adding a single tip to a single sister tip, 
(2) adding multiple tips to a single sister tip, and 
(3) adding multiple tips to multiple different sister tips. 

Branch lengths are automatically adjusted based on the number of tips being added to prevent very short branches 
that could cause numerical instability.
}
\examples{
library(ape)

# Create a simple tree
set.seed(42)
tr <- rtree(n = 4)

# Add a single sister tip
tr_single <- tree_add_sister_tip(
  tree = tr, 
  new.tip.label = "NewTip", 
  sister.tip.label = "t4")
par(mfrow = c(1, 3))
plot(tr)
plot(tr_single)
plot(tr_single, use.edge.length = F)

# Add multiple tips to a single sister (creates polytomy)
tr_poly <- tree_add_sister_tip(
  tree = tr, 
  new.tip.label = c("Tip1", "Tip2"), 
  sister.tip.label = "t4")
par(mfrow = c(1, 3))
plot(tr)
plot(tr_poly)
plot(tr_poly, use.edge.length = F)

# Add tips to different sisters
tr_multi <- tree_add_sister_tip(
  tree = tr, 
  new.tip.label = c("NewTip1", "NewTip2"), 
  sister.tip.label = c("t4", "t3"))
par(mfrow = c(1, 3))
plot(tr)
plot(tr_multi)
plot(tr_multi, use.edge.length = F)

}
