% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/phyloseq_SRS.R
\name{phyloseq_SRS}
\alias{phyloseq_SRS}
\title{Normalize phyloseq object using Scaling with Ranked Subsampling (SRS)}
\usage{
phyloseq_SRS(physeq, Cmin, drop_zeros = FALSE, set_seed = TRUE, seed = 1, ...)
}
\arguments{
\item{physeq}{A \code{\link[phyloseq]{phyloseq-class}} object containing OTU/ASV abundance data}

\item{Cmin}{Numeric. The target number of counts per sample after normalization (minimum library size)}

\item{drop_zeros}{Logical, If \code{TRUE}, remove taxa with zero abundance after normalization. Default is \code{FALSE}}

\item{set_seed}{Logical, If \code{TRUE}, set random seed for reproducibility. Default is \code{TRUE}}

\item{seed}{Numeric. Random seed value when \code{set_seed = TRUE}. Default is 1}

\item{...}{Additional arguments passed to the underlying SRS function}
}
\value{
A \code{\link[phyloseq]{phyloseq-class}} object with SRS-normalized OTU/ASV table. 
  All samples will have exactly \code{Cmin} total counts after normalization.
}
\description{
Applies Scaling with Ranked Subsampling (SRS) normalization to a phyloseq object. 
SRS is a superior alternative to rarefying that preserves the original community 
structure with greater reproducibility and minimal subsampling error. Unlike rarefying, 
SRS maintains relative frequencies of taxa and provides deterministic results.
}
\details{
SRS (Scaling with Ranked Subsampling) is a two-step normalization procedure described 
by Beule & Karlovsky (2020):

\enumerate{
  \item \strong{Scaling step}: All OTU/ASV counts are divided by a scaling factor so 
        that the sum of scaled counts equals the target \code{Cmin}. Relative frequencies 
        remain unchanged.
  \item \strong{Ranked subsampling step}: Non-integer count values are converted to 
        integers using an algorithm that minimizes subsampling error while maintaining 
        the target total count.
}

SRS provides several advantages over traditional rarefying:
\itemize{
  \item Higher reproducibility (often deterministic results)
  \item Better preservation of alpha diversity measures
  \item Minimal variance in relative abundances of taxa
  \item Improved preservation of community structure for beta diversity analysis
}
}
\examples{
library(phyloseq)
library(SRS)

# Load example data
data(esophagus)

# Check original library sizes
sample_sums(esophagus)

# Normalize to 100 reads per sample
ps_norm <- phyloseq_SRS(esophagus, Cmin = 100)

# Verify normalization
sample_sums(ps_norm)  # All should equal 100

# Remove zero-abundance taxa after normalization
ps_norm_clean <- phyloseq_SRS(esophagus, Cmin = 100, drop_zeros = TRUE)
ntaxa(ps_norm_clean)  # without zero-abundance taxa
ntaxa(ps_norm)        # with zero-abundance taxa, original number of taxa preserved

}
\references{
Beule L, Karlovsky P. (2020) Improved normalization of species count data in ecology by scaling with ranked subsampling (SRS): application to microbial communities // PeerJ 8:e9593, DOI:10.7717/peerj.9593
}
\seealso{
\code{\link{phyloseq_SRS_lowcount}} for SRS normalization with preservation of low-count samples
}
