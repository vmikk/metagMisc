% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/phyloseq_ntaxlevels.R
\name{phyloseq_ntaxlevels}
\alias{phyloseq_ntaxlevels}
\title{Estimate number of unique taxonomic levels per sample}
\usage{
phyloseq_ntaxlevels(physeq, add_all_samps = TRUE, format = "long")
}
\arguments{
\item{physeq}{A \code{phyloseq} object containing OTU table, taxonomy table, 
and sample data}

\item{add_all_samps}{Logical, if \code{TRUE} (default), includes results for 
all samples combined. If \code{FALSE}, returns only per-sample counts}

\item{format}{Character, if \code{long} (default), returns a long format data frame (3 columns). 
If \code{wide}, returns a wide format data frame (samples in columns, taxonomic ranks in rows)}
}
\value{
A data.frame.
If \code{format = "long"}, returns a long format data frame with columns:
\describe{
  \item{TaxRank}{Character vector of taxonomic rank names (Phylum, Class, Order, etc.)}
  \item{Sample}{Character vector of sample identifiers, plus "All_samples" if requested}
  \item{N.tax.levels}{Numeric vector of unique taxonomic level counts}
}
If \code{format = "wide"}, returns a wide format data frame with columns
(samples are arranged by columns, taxonomic ranks in rows)
}
\description{
Calculates the number of unique (non-NA) taxonomic assignments at each 
taxonomic rank for each sample in a phyloseq object. Useful for assessing 
taxonomic diversity and completeness of taxonomic annotations across samples.
}
\details{
The function processes each taxonomic rank and counts unique combinations at each level. 
Only taxa with non-zero abundances are included in the counts, 
and missing taxonomic assignments (NA values) are excluded from the analysis.

When \code{add_all_samps = TRUE}, an additional row with \code{Sample = "All_samples"}
provides the total unique taxonomic levels across all samples combined.
}
\examples{
library(phyloseq)
data(GlobalPatterns)

# Basic usage - count taxonomic levels per sample
tax_counts <- phyloseq_ntaxlevels(GlobalPatterns)
head(tax_counts)

# Without combined results
tax_counts_only <- phyloseq_ntaxlevels(GlobalPatterns, add_all_samps = FALSE)

# View results for a specific taxonomic rank
subset(tax_counts, TaxRank == "Family")

# Wide format
tax_counts_wide <- phyloseq_ntaxlevels(GlobalPatterns, format = "wide")
tax_counts_wide[, 1:5]

}
